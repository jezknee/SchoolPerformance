---
title: "R Notebook"
output: html_notebook
---



```{r}
education_data <- read.csv("C:\\Users\\jezkn\\Local\\Data Science Projects\\School Data\\2023-2024\\Data\\output.csv")
head(education_data)
```

```{r}
df <- subset(education_data, select = -c(RECTYPE,LEA,ESTAB,SCHNAME,PCODE,PCON_CODE,PCON_NAME,FEEDER,oa21cd,LSOA_code,MSOA_code,ladcd))
head(df,50)
```
```{r}
library(tidyverse)

df <- df %>%
  mutate(dummy=1) %>%
  pivot_wider(names_from=NFTYPE, values_from=dummy, values_fill=0, names_prefix = "SCHOOL_TYPE_") %>%
  mutate(dummy=1) %>%
  pivot_wider(names_from=ADMPOL_PT, values_from=dummy, values_fill=0, names_prefix = "ADMISSIONS_POLICY_") %>%
  mutate(dummy=1) %>%
  pivot_wider(names_from=EGENDER, values_from=dummy, values_fill=0, names_prefix = "SCHOOL_GENDER_") %>%
  mutate(dummy=1) %>%
  pivot_wider(names_from=RELDENOM, values_from=dummy, values_fill=0, names_prefix = "SCHOOL_RELIGION_")

head(df)
```
```{r}
df_check <- subset(df, select = -c(URN, PGPUP,P8PUP))
df_check <- df_check %>%
  mutate(ATT8SCR = as.numeric(ATT8SCR))
head(df_check)

df_check.cor <- data.frame(cor(df_check, use = "pairwise.complete.obs"))
df_check.cor
```
```{r}

df_check.cor <- as.matrix(df_check.cor)

library(reshape2)

# Convert correlation matrix to long format
df_long <- melt(df_check.cor)

# The result will have columns: Var1, Var2, value
# You can rename them if you want:
colnames(df_long) <- c("Variable1", "Variable2", "Correlation")

head(df_long)


write.csv(df_long, "C:\\Users\\jezkn\\Local\\Data Science Projects\\School Data\\2023-2024\\Data\\correlation_matrix2.csv", row.names = TRUE)
#library(corrplot)
#corrplot(df_check.cor)
```
```{r}
df2 <- df[, !grepl("ADMISSIONS_POLICY", colnames(df))]
df2 <- df2[, !grepl("SCHOOL_TYPE", colnames(df2))]
df2 <- df2[, !grepl("SCHOOL_GENDER", colnames(df2))]
#df2 <- df2[, !grepl("IMD_Children", colnames(df2))]
#df2 <- df2[, !grepl("IMD_Education", colnames(df2))]

df2 <- subset(df2, select = -c(IMD_Children,IMD_Education,PGPUP,P8PUP))

head(df2)
```

